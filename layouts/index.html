{{ define "main" }}
<div class="container">
    <!-- 個人簡介區塊 -->
    <section class="profile">
        <h1>你好，我是 {{ .Site.Params.author }}</h1>
        <p class="bio">{{ .Site.Params.bio }}</p>
        
        <div class="social-links">
            {{ with .Site.Params.github }}<a href="{{ . }}">GitHub</a>{{ end }}
            {{ with .Site.Params.email }}<a href="{{ . }}">Email</a>{{ end }}
        </div>
    </section>

    <!-- 主要內容區塊 (來自 content/_index.md) -->
    <section class="content">
        {{ .Content }}
    </section>

    <!-- 作品集區塊 (卡片輪播) -->
    {{ $projects := where .Site.RegularPages "Section" "projects" }}
    {{ if or $projects .Site.Params.projects }}
    <section class="projects" id="projects">
        <h2>專案內容</h2>
        <div class="carousel-container">
            {{/* 優先顯示 content/projects 下的專案 */}}
            {{ range $projects }}
            <div class="project-card">
                <img src="{{ .Params.image | relURL }}" alt="{{ .Title }}" class="project-img">
                <div class="project-title-bar">{{ .Title }}</div>
                <div class="project-overlay">
                    <h3>{{ .Title }}</h3>
                    <p>{{ .Description }}</p>
                    <a href="{{ .RelPermalink }}" class="project-link">查看詳情</a>
                </div>
            </div>
            {{ end }}
            
            {{/* 如果沒有 content 專案，則顯示 config 中的 (相容舊設定) */}}
            {{ if not $projects }}
                {{ range .Site.Params.projects }}
                <div class="project-card">
                    <img src="{{ .image | relURL }}" alt="{{ .title }}" class="project-img">
                    <div class="project-title-bar">{{ .title }}</div>
                    <div class="project-overlay">
                        <h3>{{ .title }}</h3>
                        <p>{{ .description }}</p>
                        <a href="{{ .link }}" class="project-link">查看詳情</a>
                    </div>
                </div>
                {{ end }}
            {{ end }}
        </div>
    </section>
    {{ end }}

    <!-- 最新文章區塊 -->
    <section class="recent-posts">
        <h2>最新文章</h2>
        <ul class="recent-posts-list">
            {{ range first 5 (where .Site.RegularPages "Section" "blog") }}
            <li class="recent-post-item">
                <a href="{{ .RelPermalink }}">
                    <span class="recent-post-title">{{ .Title }}</span>
                    <time class="recent-post-date">{{ .Date.Format "2006-01-02" }}</time>
                </a>
            </li>
            {{ end }}
        </ul>
    </section>
</div>
{{ end }}