<!DOCTYPE html>
<html lang="{{ .Site.LanguageCode | default "zh-tw" }}">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ if not .IsHome }}{{ .Title }} | {{ end }}{{ .Site.Title }}</title>
    <link rel="stylesheet" href="{{ "css/style.css" | relURL }}">
    {{/*  æ‚¨å¯ä»¥å°‡ favicon.ico æ”¾åœ¨ static/ è³‡æ–™å¤¾ä¸‹  */}}
    {{ if fileExists "static/favicon.ico" }}
    <link rel="icon" href="{{ "favicon.ico" | relURL }}">
    {{ end }}
</head>
<body>

    {{ partial "header.html" . }}

    <div class="site-wrapper">
        {{ partial "sidebar.html" . }}
        <div class="content-wrapper">
            {{ block "main" . }}{{ end }}
        </div>
    </div>

    {{ partial "footer.html" . }}

    <button id="back-to-top" title="Go to top">â†‘</button>
    {{ block "scripts" . }}{{ end }}
    <script>
        // Back to top button logic
        const backToTopButton = document.getElementById('back-to-top');
        if (backToTopButton) {
            window.addEventListener('scroll', () => {
                if (window.scrollY > 200) {
                    backToTopButton.classList.add('show');
                } else {
                    backToTopButton.classList.remove('show');
                }
            });
            backToTopButton.addEventListener('click', () => {
                window.scrollTo({ top: 0, behavior: 'smooth' });
            });
        }

        // Theme toggle logic
        const themeToggle = document.getElementById('theme-toggle');
        const body = document.body;

        const applyTheme = (theme) => {
            if (theme === 'dark') {
                body.classList.add('dark-mode');
                if (themeToggle) themeToggle.innerHTML = 'ğŸŒ™';
            } else {
                body.classList.remove('dark-mode');
                if (themeToggle) themeToggle.innerHTML = 'â˜€ï¸';
            }
        };

        if (themeToggle) themeToggle.addEventListener('click', () => { const newTheme = body.classList.contains('dark-mode') ? 'light' : 'dark'; applyTheme(newTheme); localStorage.setItem('theme', newTheme); });
        document.addEventListener('DOMContentLoaded', () => { const savedTheme = localStorage.getItem('theme'); if (savedTheme) { applyTheme(savedTheme); } else if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) { applyTheme('dark'); } });
    </script>
</body>
</html>